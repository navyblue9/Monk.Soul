/*!
 * backend.js
 * version: 1.0.0
 * author: 百小僧（QQ：8020292）
 * site：http://www.baisoft.org
 */
!function(n){"use strict";if(typeof require=="function"&&typeof exports=="object"&&typeof module=="object"){var t=module.exports||exports;n(t)}else typeof define=="function"&&define.amd?define(["exports"],n):n(window.backend={})}(function(n){var t=typeof n!="undefined"?n:{};t.v="1.0.0";t.successTip=function(n,t,i){t=t||{};var r=$.extend(!0,{icon:1,offset:0},t),u=parent.layer?parent.layer:layer;return u.msg(n,r,i)};t.errorTip=function(n,t,i){t=t||{};var r=$.extend(!0,{icon:2,offset:0},t),u=parent.layer?parent.layer:layer;return u.msg(n,r,i)};t.loadTip=function(n,t,i){t=t||{};var r=$.extend(!0,{icon:16,time:3e4,offset:0},t),u=parent.layer?parent.layer:layer;return u.msg(n,r,i)};t.Tip=function(n,t,i){t=t||{};var r=$.extend(!0,{icon:0,offset:0},t),u=parent.layer?parent.layer:layer;return u.msg(n,r,i)};t.validform=function(n,t,i){var r=this,f,u;return i=i||{},f={form:".monk-form",btnSubmit:".monk-form-submit",btnReset:".monk-form-reset",tiptype:function(n,t){switch(t.type){case 1:r.loadTip("正在校检数据合法性...");break;case 2:r.successTip(n);break;case 3:r.errorTip(n);break;case 4:r.Tip(n)}},ignoreHidden:!1,dragonfly:!1,tipSweep:!0,label:"",showAllError:!1,postonce:!0,ajaxPost:!0,datatype:{},usePlugin:{},beforeCheck:function(){},beforeSubmit:function(n){r.loadTip("正在校检数据合法性...");typeof t=="function"&&t(n)},callback:function(t){if(t.status==404)return r.errorTip("远程地址没找到"),!1;if(t.status>=500)return r.errorTip("应用程序异常"),!1;if(t.status=="n"||t.status=="not_allow")return r.errorTip(t.info),t.selector&&$(t.selector)&&$(t.selector).focus(),!1;t.status=="y"&&(r.successTip(t.info),typeof n=="function"&&n(t))}},u=$.extend(!0,f,i),$(u.form).Validform(u)};t.ajaxResultHandle=function(n,t){var i=this;if(n.status=="not_allow")return i.errorTip(n.info),!1;typeof t=="function"&&t(n)};t.nicescroll=function(n,t){t=t||{};var i=$.extend(!0,{cursorcolor:"#9f9f9f",cursoropacitymax:1,touchbehavior:!1,cursorwidth:"2px",cursorborder:"0",cursorborderradius:"2px",autohidemode:!0},t);return n.niceScroll(i)};t.fileUpload=function(n){var u=this;n=n||{};var i,f="pending",h={options:{auto:!1,swf:"/Areas/Backend/Assets/Vendors/webuploader-v0.1.6/dist/Uploader.swf",server:"/Services/Common/UploadImage ",pick:{id:"",multiple:!1},accept:{title:"已选择图片",extensions:"gif,jpg,jpeg,bmp,png",mimeTypes:"image/*"},compress:!1,fileSingleSizeLimit:2097152},input:"#uploadUrl",progress:"#uploadProgress",selectBtn:"#selectFiles",startBtn:"#startUpload",removeBtn:"#removeFile",clearBtn:"#clearUpload",data:{},headers:{SecretKey:"d86c2c08c8c2247ec59c4ddeaaf4598a"},fileQueued:function(){},fileDequeued:function(){},startUpload:function(){},uploadBeforeSend:function(){},uploadProgress:function(){},uploadSuccess:function(){},uploadError:function(){},uploadComplete:function(){},error:function(){},all:function(){},reset:function(){}},t=$.extend(!0,h,n);t.options.pick.id=t.selectBtn;var r=$(t.input),o=$(t.progress),s=$(t.startBtn),c=$(t.removeBtn),e=$(t.clearBtn);i=WebUploader.create(t.options);i.on("fileQueued",function(n){f="pending";i.getStats().queueNum>0&&i.removeFile(r.attr("data-fileId"));r.val("等待上传："+n.name).attr("data-fileId",n.id);o.css("width","0%");typeof t.fileQueued=="function"&&t.fileQueued(n)});i.on("fileDequeued",function(n){u.Tip("已将已选择的文件从上传队列中移除");typeof t.fileDequeued=="function"&&t.fileDequeued(n)});i.on("startUpload",function(){i.getStats().queueNum==0&&u.errorTip("没有检测到文件或文件已上传");typeof t.startUpload=="function"&&t.startUpload()});i.on("uploadBeforeSend",function(n,i,r){i=$.extend(!0,i,t.data);r=$.extend(!0,r,t.headers);typeof t.uploadBeforeSend=="function"&&t.uploadBeforeSend(n,i,r)});i.on("uploadProgress",function(n,i){r.val("上传中："+n.name);o.css("width",i*100+"%");typeof t.uploadProgress=="function"&&t.uploadProgress(n,i)});i.on("uploadSuccess",function(n,i){i.status=="n"?(r.val("上传失败："+n.name).attr("data-fileId",n.id),u.errorTip(i.info)):i.status=="not_allow"?(r.val("上传失败："+n.name).attr("data-fileId",n.id),u.errorTip(i.info)):i.status=="y"&&(r.val("上传成功："+n.name).attr("data-fileId",n.id),e.removeAttr("disabled"),u.successTip(i.info),typeof t.uploadSuccess=="function"&&t.uploadSuccess(n,i))});i.on("uploadError",function(n,i){u.errorTip("上传出错"+i);typeof t.uploadError=="function"&&t.uploadError(n,i)});i.on("uploadComplete",function(n){o.css("width","0%");typeof t.uploadComplete=="function"&&t.uploadComplete(n)});i.on("error",function(n){n=="Q_TYPE_DENIED"?u.errorTip("不支持该文件类型"):n=="Q_EXCEED_SIZE_LIMIT"?u.errorTip("该文件超过最大限制："+t.options.fileSingleSizeLimit/1048576+" M"):n=="Q_EXCEED_NUM_LIMIT"&&u.errorTip("选择文件的总数已超过可选的大小");e.attr("disabled","disabled");typeof t.error=="function"&&t.error(n)});i.on("all",function(n){n==="startUpload"?f="uploading":n==="stopUpload"?f="paused":n==="uploadFinished"&&(f="done");f==="uploading"?(r.val(r.val().replace("上传中：","暂停上传：")),s.text("暂停上传")):s.text("开始上传");typeof t.all=="function"&&t.all(n)});i.on("reset",function(){u.Tip("上传组件已恢复初始值");typeof t.reset=="function"&&t.reset();typeof t.fileDequeued=="function"&&t.fileDequeued()});s.on("click",function(){f==="uploading"?i.stop():i.upload()});c.on("click",function(){e.attr("disabled","disabled");i.removeFile(r.attr("data-fileId"));r.val("未选择文件")});e.on("click",function(){i.reset();r.val("未选择文件");$(this).attr("disabled","disabled")});return i};t.pagination=function(n,t,i,r,u,f){u=u?u:"#page";f=f||{};i=i||{};t=Number(t)?Math.abs(Number(t)):15;var e={pageSize:t,total:1e3,pageBtnCount:7,showInfo:!0,infoFormat:"共 {total} 条记录",noInfoText:"共 0 条记录",showJump:!0,jumpBtnText:"转到",showPageSizes:!0,pageSizeItems:[5,10,15,20,25,30],remote:{url:n,params:i,success:function(n){typeof r=="function"&&r(n)},beforeSend:function(){},complete:function(){},totalName:"data.others.total",traditional:!0}},o=$.extend(!0,e,f);$(u).pagination(o)}});