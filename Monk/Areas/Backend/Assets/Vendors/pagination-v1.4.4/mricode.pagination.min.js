/*!
 * Mricode Pagination Plugin
 * Github: https://github.com/mricle/Mricode.Pagination
 * Version: 1.4.4
 * 
 * Required jQuery
 * 
 * Copyright 2016 Mricle
 * Released under the MIT license
 */
(function(n){typeof define=="function"&&define.amd?define(["jquery"],n):typeof exports=="object"?n(require("jquery")):n(jQuery)})(function(n){"use strict";var u=function(r,u){var f={pageIndex:0,pageSize:10,total:0,pageBtnCount:11,showFirstLastBtn:!0,firstBtnText:null,lastBtnText:null,prevBtnText:"&laquo;",nextBtnText:"&raquo;",loadFirstPage:!0,remote:{url:null,params:null,pageParams:null,success:null,beforeSend:null,complete:null,pageIndexName:"pageIndex",pageSizeName:"pageSize",totalName:"total",traditional:!1},pageElementSort:["$page","$size","$jump","$info"],showInfo:!1,infoFormat:"{start} ~ {end} of {total} entires",noInfoText:"0 entires",showJump:!1,jumpBtnText:"Go",showPageSizes:!1,pageSizeItems:[5,10,15,20],debug:!1};this.$element=n(r);this.$page=n('<ul class="m-pagination-page"><\/ul>').hide();this.$size=n('<div class="m-pagination-size"><\/div>').hide();this.$jump=n('<div class="m-pagination-jump"><\/div>').hide();this.$info=n('<div class="m-pagination-info"><\/div>').hide();this.options=n.extend(!0,{},f,n.fn.pagination.defaults,u);this.options.pageElementSort=u.pageElementSort?u.pageElementSort:n.fn.pagination.defaults&&n.fn.pagination.defaults.pageElementSort?n.fn.pagination.defaults.pageElementSort:f.pageElementSort;this.options.pageSizeItems=u.pageSizeItems||(n.fn.pagination.defaults&&n.fn.pagination.defaults.pageSizeItems?n.fn.pagination.defaults.pageSizeItems:f.pageSizeItems);this.total=this.options.total;this.currentUrl=this.options.remote.url;this.currentPageIndex=t.convertInt(this.options.pageIndex);this.currentPageSize=t.convertInt(this.options.pageSize);this.currentParams=t.deserializeParams(this.options.remote.params)||{};this.getLastPageNum=function(){return i.core.calLastPageNum(this.total,this.currentPageSize)};this.options.remote.success===null&&(this.options.remote.success=this.options.remote.callback);this.init()},r,i,t;u.prototype={getPageIndex:function(){return this.currentPageIndex},getPageSize:function(){return this.currentPageSize},getParams:function(){return this.currentParams},setPageIndex:function(n){n!==undefined&&n!==null&&(this.currentPageIndex=t.convertInt(n))},setPageSize:function(n){n!==undefined&&n!==null&&(this.currentPageSize=t.convertInt(n))},setRemoteUrl:function(n){n&&(this.currentUrl=n)},setParams:function(n){n&&(this.currentParams=t.deserializeParams(n))},render:function(n){n!==undefined&&n!==null&&(this.total=t.convertInt(n));this.renderPagination();this.debug("pagination rendered")},init:function(){this.initHtml();this.initEvent();this.currentUrl&&this.options.loadFirstPage?this.remote():this.renderPagination();this.debug("pagination inited")},initHtml:function(){for(var r,i=n('<select data-page-btn="size"><\/select>'),t=0;t<this.options.pageSizeItems.length;t++)i.append('<option value="'+this.options.pageSizeItems[t]+'" '+(this.currentPageSize==this.options.pageSizeItems[t]?"selected":"")+" >"+this.options.pageSizeItems[t]+"<\/option>");for(i.val(this.currentPageSize),this.$size.append(i),r='<div class="m-pagination-group"><input data-page-btn="jump" type="text"><button data-page-btn="jump" type="button">'+this.options.jumpBtnText+"<\/button><\/div>",this.$jump.append(r),t=0;t<this.options.pageElementSort.length;t++)this.$element.append(this[this.options.pageElementSort[t]])},initEvent:function(){this.$element.on("click",{page:this},function(t){if(n(t.target).is("button")){if(n(t.target).data("pageBtn")=="jump"){var i=t.data.page.$element.find("input[data-page-btn=jump]");t.data.page.jumpEventHandler(i.val(),t)}}else n(t.target).data("pageIndex")!==undefined&&r.call(t.data.page,t)}).on("change",{page:this},function(t){var i=n(t.target);i.data("pageBtn")=="jump"&&t.data.page.jumpEventHandler(i.val(),t);i.data("pageBtn")=="size"&&r.call(t.data.page,t)}).on("keypress",{page:this},function(n){if(n.keyCode=="13"){var t=n.data.page.$element.find("input[data-page-btn=jump]");n.data.page.jumpEventHandler(t.val(),n)}})},jumpEventHandler:function(n,u){n?i.check.checkJumpPage(n)?t.convertInt(n)>this.getLastPageNum()?this.$jump.addClass("error"):(this.$jump.removeClass("error"),r.call(this,u)):this.$jump.addClass("error"):this.$jump.removeClass("error")},doPagination:function(){this.currentUrl?this.remote():this.renderPagination()},remote:function(){if(typeof this.options.remote.pageParams=="function"){var t=this.options.remote.pageParams.call(this,{pageIndex:this.currentPageIndex,pageSize:this.currentPageSize});this.currentParams=n.extend({},this.currentParams,t)}else this.currentParams[this.options.remote.pageIndexName]=this.currentPageIndex,this.currentParams[this.options.remote.pageSizeName]=this.currentPageSize;i.remote.getAjax(this,this.currentUrl,this.currentParams,this.ajaxCallBack,this.options.remote.beforeSend,this.options.remote.complete,this.options.remote.traditional)},ajaxCallBack:function(n){var i=t.mapObjectNameRecursion(n,this.options.remote.totalName),r;if(i==null||i==undefined)throw new Error("the response of totalName :  '"+this.options.remote.totalName+"'  not found.");i=t.convertInt(i);this.total=i;r=this.getLastPageNum();this.currentPageIndex>0&&r-1<this.currentPageIndex?(this.setPageIndex(r-1),this.remote()):(typeof this.options.remote.success=="function"&&this.options.remote.success(n),this.renderPagination())},onEvent:function(n,i,r){i!=null&&(this.currentPageIndex=t.convertInt(i));r!=null&&(this.currentPageSize=t.convertInt(r));this.doPagination();this.$element.trigger(n,{pageIndex:this.currentPageIndex,pageSize:this.currentPageSize});this.debug("pagination "+n)},renderPagination:function(){var t={showFirstLastBtn:this.options.showFirstLastBtn,firstBtnText:this.options.firstBtnText,prevBtnText:this.options.prevBtnText,nextBtnText:this.options.nextBtnText,lastBtnText:this.options.lastBtnText},n=this.getLastPageNum();this.currentPageIndex=n>0&&this.currentPageIndex>n-1?n-1:this.currentPageIndex;this.$page.empty().append(i.core.renderPages(this.currentPageIndex,this.currentPageSize,this.total,this.options.pageBtnCount,t)).show();this.options.showPageSizes&&n!==0?this.$size.show():this.$size.hide();this.options.showJump&&n!==0?this.$jump.show():this.$jump.hide();this.$info.text(i.core.renderInfo(this.currentPageIndex,this.currentPageSize,this.total,this.options.infoFormat,this.options.noInfoText));this.options.showInfo?this.$info.show():this.$info.hide()},destroy:function(){this.$element.unbind().data("pagination",null).empty();this.debug("pagination destroyed")},debug:function(n,t){this.options.debug&&console&&(n&&console.info(n+" : pageIndex = "+this.currentPageIndex+" , pageSize = "+this.currentPageSize+" , total = "+this.total),t&&console.info(t))}};r=function(r){var u=r.data.page,f=n(r.target),o,s,e;if(r.type!=="click"||f.data("pageIndex")===undefined||f.parent().hasClass("active")){if((r.type==="click"||r.type==="keypress")&&f.data("pageBtn")==="jump"){if(o=u.$jump.find("input").val(),t.convertInt(o)<=u.getLastPageNum()){u.onEvent(i.event.jumpClicked,o-1,null);u.$jump.find("input").val(null)}}else if(r.type==="change"&&f.data("pageBtn")==="size"){s=u.$size.find("select").val();e=i.core.calLastPageNum(u.total,s);e>0&&u.currentPageIndex>e-1&&(u.currentPageIndex=e-1);u.onEvent(i.event.pageSizeChanged,u.currentPageIndex,s)}}else u.onEvent(i.event.pageClicked,f.data("pageIndex"),null)};i={};i.event={pageClicked:"pageClicked",jumpClicked:"jumpClicked",pageSizeChanged:"pageSizeChanged"};i.remote={getAjax:function(t,i,r,u,f,e,o){n.ajax({url:i,dataType:"json",data:r,cache:!1,traditional:o,contentType:"application/Json",beforeSend:function(n){typeof f=="function"&&f.call(this,n)},complete:function(n,t){typeof e=="function"&&e.call(this,n,t)},success:function(n){u.call(t,n)}})}};i.core={renderPages:function(n,t,i,r,u){u=u||{};var e=n+1,s=this.calLastPageNum(i,t),f=[];if(s<=r)f=this.renderGroupPages(1,s,e);else{var v=this.renderPerPage(u.firstBtnText||1,0),y=this.renderPerPage(u.lastBtnText||s,s-1),o=(r-5)/2;u.showFirstLastBtn||(o=o+1);var h=(r+1)/2,c=s-(r+1)/2,l=this.renderPerPage(u.prevBtnText,n-1),a=this.renderPerPage(u.nextBtnText,n+1);o=o.toString().indexOf(".")==-1?o:o+.5;h=h.toString().indexOf(".")==-1?h:h+.5;c=c.toString().indexOf(".")==-1?c:c+.5;e<h?u.showFirstLastBtn?(f=this.renderGroupPages(1,r-2,e),f.push(a),f.push(y)):(f=this.renderGroupPages(1,r-1,e),f.push(a)):e>c?u.showFirstLastBtn?(f=this.renderGroupPages(s-r+3,r-2,e),f.unshift(l),f.unshift(v)):(f=this.renderGroupPages(s-r+2,r-1,e),f.unshift(l)):u.showFirstLastBtn?(f=this.renderGroupPages(e-o,r-4,e),f.unshift(l),f.push(a),f.unshift(v),f.push(y)):(f=this.renderGroupPages(e-o,r-2,e),f.unshift(l),f.push(a))}return f},renderGroupPages:function(n,t,i){for(var r,u=[],f=0;f<t;f++)r=this.renderPerPage(n,n-1),n===i&&r.addClass("active"),u.push(r),n++;return u},renderPerPage:function(t,i){return n("<li><a data-page-index='"+i+"'>"+t+"<\/a><\/li>")},renderInfo:function(n,t,i,r,u){if(i<=0)return u;var e=n*t+1,f=(n+1)*t;return f=f>=i?i:f,r.replace("{start}",e).replace("{end}",f).replace("{total}",i)},calLastPageNum:function(n,i){n=t.convertInt(n);i=t.convertInt(i);var r=n/i;return t.isDecimal(r)?parseInt(r)+1:r}};i.check={checkJumpPage:function(n){return/^\+?[1-9][0-9]*$/.test(n)}};t={convertInt:function(n){if(typeof n=="number")return n;var t=parseInt(n);if(isNaN(t))throw new Error("convertInt Type Error.  Type is "+typeof n+", value = "+n);else return t},isDecimal:function(n){return parseInt(n)!==n},mapObjectNameRecursion:function(n,i){for(var r=n,f=i.split("."),u=0;u<f.length;u++)r=t.mapObjectName(r,f[u]);return r},mapObjectName:function(n,t){var r=null;for(var i in n)if(n.hasOwnProperty(i)&&i==t){r=n[i];break}return r},deserializeParams:function(n){var i={},r,u,t;if(typeof n=="string")for(r=n.split("&"),t=0;t<r.length;t++)u=r[t].split("="),i[u[0]]=decodeURIComponent(u[1]);else if(n instanceof Array)for(t=0;t<n.length;t++)i[n[t].name]=decodeURIComponent(n[t].value);else typeof n=="object"&&(i=n);return i}};n.fn.pagination=function(t){if(typeof t=="undefined")return n(this).data("pagination")||!1;var i,r=arguments;return this.each(function(){var o=n(this),f=o.data("pagination"),e,s;if(f||typeof t!="string")if(f&&typeof t=="object")throw new Error("MricodePagination is initialized.");else f||typeof t!="object"?f&&typeof t=="string"&&(i=f[t].apply(f,Array.prototype.slice.call(r,1))):(e=typeof t=="object"&&t,s=o.data(),e=n.extend(e,s),o.data("pagination",f=new u(this,e)));else throw new Error("MricodePagination is uninitialized.");}),typeof i=="undefined"?this:i}});